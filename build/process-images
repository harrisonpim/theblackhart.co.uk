#!/bin/bash

LITTLE=1000
LARGE=2500

ROOT=$(git rev-parse --show-toplevel)
RAW_DIR="${ROOT}/assets/raw_images"
PROCESSED_DIR="$ROOT/assets/processed_images"
rm -rf $PROCESSED_DIR
mkdir $PROCESSED_DIR

for FILE_PATH in $RAW_DIR/*; do
    BASE_NAME=$(basename -- ${FILE_PATH})
    FILE_NAME=${BASE_NAME%%.*}
    FILE_EXT=${BASE_NAME#*.}
    echo "processing ${BASE_NAME}"

    magick $FILE_PATH -resize $LITTLE\> -define webp:lossless=true $PROCESSED_DIR/${FILE_NAME}_little.webp
    magick $FILE_PATH -resize $LARGE\> -define webp:lossless=true $PROCESSED_DIR/${FILE_NAME}_large.webp
    magick $FILE_PATH -resize $LITTLE\> $PROCESSED_DIR/${FILE_NAME}_little.${FILE_EXT}
    magick $FILE_PATH -resize $LARGE\> $PROCESSED_DIR/${FILE_NAME}_large.${FILE_EXT}
done
